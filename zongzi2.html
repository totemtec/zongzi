<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>浓情端午，粽享好礼</title>
    <meta name="keywords" content="" />
	<meta name="description" content="" />
	<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no,minimal-ui">
	<meta name="format-detection" content="telephone=no,address=no" />
	<meta name="referrer" content="always">
	<meta name="apple-mobile-web-app-capable" content="no" />
	<meta name="apple-mobile-web-app-status-bar-style" content="no" />
	<meta content="email=no" name="format-detection" />
	<script type="text/javascript" src="js/app.js"></script>
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<link rel="stylesheet" href="css/m_main.css" />

	<!-- <script src="js/vconsole.min.js"></script>
	<script>
		// 初始化
		var vConsole = new VConsole();
	</script> -->
	
</head>
<body>
	<div class="mask" id="mask0" style="display:none;"></div>
	<div class="mask" id="mask1" style="display:none;"></div>
<!--分享弹窗开始-->
	<div class="sharetext" style="display:none;">
		<span></span>
		<p class="bs">点击右上角将活动转给好友，求帮忙集粽子，集齐四种粽子即可打开礼包，有机会获得端午好礼哦～</p>
	</div>
<!--分享弹窗结束-->
<!--关注公众号开始-->
	<div class="gzgzhbox" style="display:none;">
		<h2>粉丝专属福利哦</h2>
		<img src="images/wx.png" />
		<h4>识别二维码参与</h4>
		<a class="closebtn">知道了</a>
	</div>
<!--关注公众号结束-->
<!--收集一枚粽子弹窗开始-->
	<div class="collectcg" style="display:none;" id="likeSuccess">
		<span class="closebtn">关闭</span>
		<div class="poupbox">
			<img src="images/tc_sjcg.png"/>
			<a class="linkbtn" id="wantPlayOnDialog">我也要参加</a>
		</div>
	</div>
<!--收集一枚粽子弹窗结束-->
<!--中奖了弹窗开始-->
	<div class="collectcg explainbox" style="display:none;" id="giftGoods" >
		<span class="closebtn">关闭</span>
		<div class="poupbox">
			<img src="images/zjltop.png"/>
			<div class="msgbox zjlbox">
				<p>恭喜您获得精美化妆品礼盒（价值341元）</p>
				<p>礼盒内含以下产品——</p>
				<p>娇韵诗双粹焕活修护精华露0.9ml</p>
				<p>娇韵诗塑颜紧致精华乳5ml</p>
				<p>娇韵诗沁润奇肌保湿精华液3.5ml</p>
				<p>娇韵诗清透润白淡斑亮肤精华乳3ml</p>
				<p>娇韵诗青春赋活日间霜5ml</p>
				<p>娇韵诗青春赋活晚间霜5ml</p>
			</div>
			<a class="linkbtn" href="address.html" onclick="giftGoodsDismiss()">填写联系地址</a>
		</div>
	</div>
<!--中奖了弹窗结束-->
<!--中奖了视频会员卡弹窗开始-->
	<div class="collectcg explainbox2" style="display:none;" id="giftCode">
		<span class="closebtn">关闭</span>
		<div class="poupbox">
			<img src="images/zjltop2.png"/>
			<div class="msgbox zjlbox">
				<p>恭喜您获得腾讯视频VIP月卡</p>
			</div>
			<a class="linkbtn" href="mygift.html" onclick="giftCodeDismiss()">查看激活码</a>
		</div>
	</div>
<!--中奖了视频会员卡弹窗结束-->
<!--重复领取礼品结束-->
<div class="collectcg" style="display:none;" id="duplicatedGift">
	<span class="closebtn">关闭</span>
	<div class="poupbox">
		<img src="images/tc_lingguole.png"/>
	</div>
</div>
<!--重复领取礼品结束-->
<!--重复助力弹窗开始-->
	<div class="collectcg" style="display:none;" id="duplacatedLike">
		<span class="closebtn">关闭</span>
		<div class="poupbox">
			<img src="images/tc_cfzl.png"/>
			<a class="linkbtn" id="wantPlayOnDialog2">我也要参加</a>
		</div>
	</div>
<!--重复助力弹窗结束-->
<!--未中奖弹窗开始-->
	<div class="collectcg" style="display:none;" id="giftNone">
		<span class="closebtn">关闭</span>
		<div class="poupbox">
			<img src="images/tc_wzj.png"/>
		</div>
	</div>
<!--未中奖弹窗结束-->
<!--未获得礼品弹窗开始-->
	<div class="collectcg" style="display:none;">
		<span class="closebtn">关闭</span>
		<div class="poupbox">
			<img src="images/tc_wjp.png"/>
		</div>
	</div>
<!--未获得礼品弹窗结束-->
	<section class="contentbox jzzbox">
		<div class="headbox">
			<span><img src="images/zz1.png" id="avatar"/></span>
			<p id="nickname">昵称</p>
		</div>
		<div class="mygift" style="display:none;" id="mygift">
			<a href="mygift.html">我的礼品</a>
		</div>
		<h2 class="titlesp" id="titleTips">全部集齐可以打开礼包</h2>
		<div class="giftpt"><img src="images/lwpt.png"/></div>
		<div class="zzbox">
			<span class="cfz" id="zongzi0">财富粽</span>
			<span class="jkz" id="zongzi1">健康粽</span>
			<span class="xfz" id="zongzi2">幸福粽</span>
			<span class="syz" id="zongzi3">事业粽</span>
		</div>
		<div class="fridebox">
			<ul>
				<li style="display: none;" id="user0">
					<span><img src="images/zz1.png" id="avatar0"/></span>
					<p class="userNickName" id="nickname0">好友昵称</p>
				</li>
				<li style="display: none;" id="user1">
					<span><img src="images/zz1.png" id="avatar1"/></span>
					<p class="userNickName" id="nickname1"></p>
				</li>
				<li style="display: none;" id="user2">
					<span><img src="images/zz1.png" id="avatar2"/></span>
					<p class="userNickName" id="nickname2"></p>
				</li>
				<li style="display: none;" id="user3">
					<span><img src="images/zz1.png" id="avatar3"/></span>
					<p class="userNickName" id="nickname3"></p>
				</li>
			</ul>
		</div>
		<h5 id="statusTips">邀请4位好友帮忙收集粽子就可打开礼包</h5>
		<a class="lqgiftbtn" id="play" href="#statusTips">找好友集粽子</a>
		<a class="lqgiftbtn" id="gift" style="display: none;">打开礼包</a>
		<a class="lqgiftbtn" id="like" style="display: none;">帮好友助力</a>
		<a class="lqgiftbtn" id="wantPlay" style="display: none;">我也要参与</a>
		<div class="rulebox bs">
			<h3>活动说明</h3>
			<h4>[ 活动时间 ]</h4>
			<p>2020年6月24日-6月28日</p>
			<h4>[ 活动礼品 ]</h4>
			<p>精美化妆品礼盒（价值341元）1套（共计20个名额）或腾讯视频VIP月卡1张（共计1000个名额）</p>
			<h4>[ 活动规则 ]</h4>
			<p><span>1.</span>客户关注“盛京银行”微信公众号即可参与本活动。</p>
				<p><span>2.</span>点击【集福粽】进入活动页面，邀请好友助力收集粽子，集齐4个粽子即可打开礼包，有机会获得端午好礼。</p>
				<p><span>3.</span>同一客户仅可打开1次礼包，同一微信号视为同一客户。</p>
				<p><span>4.</span>每位好友仅可助力1次，好友也可关注公众号并参与活动。</p>
				<p><span>5.</span>实物奖品中奖者需填写联系方式，奖品将于活动结束后十个工作日内免费邮寄至填写地址；其他奖品将以电子码形式线上派奖。</p>
				<p><span>6.</span>如有疑问可咨询盛京银行客服电话95337.</p>
				<p><span>7.</span>客户参与活动即视为同意本活动规则，盛京银行有权在中国法律范围内修改本活动规则。</p>
				<p><span>8.</span>本活动最终解释权归盛京银行所有。</p>
		</div>
	</section>
<script type="text/javascript">
		//关闭分享弹窗
		$(".header .textbtn").click(function(){
			$(".sharetext").fadeOut();
			$(".mask").fadeOut();
		})

		$("#mask0").click(function(){
			$(".sharetext").fadeOut();
			$(".mask").fadeOut();
			$("#duplicatedGift").fadeOut();
		})

		//关闭公众号弹窗
		$(".gzgzhbox .closebtn").click(function(){

			shareKey = getQueryString('uk');
			refreshUserInfo(shareKey);

			$(".gzgzhbox").fadeOut();
			$("#mask1").fadeOut();
		})

		//关闭弹窗
		$(".collectcg .closebtn").click(function(){
			$(".collectcg").fadeOut();
			$(".mask").fadeOut();
		})

		$("#play").click(function(){
			let user  = getUser();
			if (user && user.subscribe == 0) {
				$(".gzgzhbox").fadeIn();
				$("#mask1").fadeIn();
			} 
			else {
				// $(".sharetext").fadeIn();
				// $("#mask0").fadeIn();
				var $anchor = $(this);
				$('html, body').stop().animate({
					scrollTop: $($anchor.attr('href')).offset().top
				}, 350);
			}
		});

		$("#wantPlayOnDialog").click(function(){
			window.location.assign('https://wxsp.totemtec.com/zongzi2.html');
		});
		$("#wantPlayOnDialog2").click(function(){
			window.location.assign('https://wxsp.totemtec.com/zongzi2.html');
		});

		$("#wantPlay").click(function(){
			let user  = getUser();
			if (user && user.subscribe == 0) {
				$(".gzgzhbox").fadeIn();
				$("#mask1").fadeIn();
			} else {
				window.location.assign('https://wxsp.totemtec.com/zongzi2.html');
			}
		});

		$("#like").click(function(){
			// let user  = getUser();
			// if (user==null || user.subscribe == 0) {
			// 	$(".gzgzhbox").fadeIn();
			// 	$("#mask1").fadeIn();
			// 	return;
			// }

			shareKey = getQueryString('uk');
		
			likeShareUser(shareKey);
		});

		$("#duplacatedLike closebtn").click(function(){
			$('#duplacatedLike').fadeOut();
			$('#mask1').fadeOut();
		});

		$("#gift").click(function(){
			gameLucky();
		});
		
		$("#playGame").click(function(){
			$('#likeSuccess').fadeOut();
			$('#mask1').fadeOut();
			setTimeout(function(){ 
				window.location.assign('https://wxsp.totemtec.com/zongzi2.html');
			}, 1000);
		});

		function showGift(gift) {
			let user = getUser();
			if (user) {
				user.userGift = gift;
				setUser(user);
			}

			//未中奖
			if (gift.status == 0) {
				$('#giftNone').fadeIn();
				$('#mask1').fadeIn();
			} else if(gift.duplicated) {
				$('#duplicatedGift').fadeIn();
				$('#mask0').fadeIn();
				$('#mygift').css('display', 'block');
			} else {
				$('#mygift').css('display', 'block');
				if (gift.packageType == 1) {
					//虚拟礼品
					$('#giftCode').fadeIn();
					$('#mask1').fadeIn();
				} else if (gift.packageType == 2) {
					//实物礼品
					$('#giftGoods').fadeIn();
					$('#mask1').fadeIn();
				}
			}
		}
	function gameLucky() {

		let user = getUser();
		if (user && user.userGift) {
			if (user.userGift.status == 0) {
				$('#giftNone').fadeIn();
				$('#mask1').fadeIn();
			} else {
				$('#duplicatedGift').fadeIn();
				$('#mask0').fadeIn();
			}
			
			return;
		}

		let url = 'https://wxspapi.totemtec.com/game/lucky';

		$.getJSON(url, function (res) {
			if (res.code == 1 && res.data) {
				showGift(res.data);
			}
		});
	}

	function giftGoodsDismiss() {
		$('#giftGoods').css('display', 'none');
		$('.mask').css('display', 'none');
	}

	function giftCodeDismiss() {
		$('#giftCode').css('display', 'none');
		$('.mask').css('display', 'none');
	}


	</script>

<script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.6.0.js"></script>
<script type="text/javascript" src="https://res.wx.qq.com/open/libs/weuijs/1.2.1/weui.min.js"></script>

<script type="text/javascript" src="js/global.js"></script>

<script type="text/javascript" src="js/wechat.js" ></script>


<script type="text/javascript">

const zongziPage = true;

function showGameData(user) {
	$('#avatar').attr("src", user.avatar);
	$('#nickname').text(user.nickName);

	let likeList = user.likeList;
	if (likeList.length > 0) {
		let user0 = likeList[0];
		$('#zongzi0').addClass('active');
		$('#user0').css('display','block');
		$('#avatar0').attr("src", user0.avatar);
		$('#nickname0').text(user0.nickName)
	}

	if (likeList.length > 1) {
		let user1 = likeList[1];
		$('#zongzi1').addClass('active');
		$('#user1').css('display','block');
		$('#avatar1').attr("src", user1.avatar);
		$('#nickname1').text(user1.nickName)
	}

	if (likeList.length > 2) {
		let user2 = likeList[2];
		$('#zongzi2').addClass('active');
		$('#user2').css('display','block');
		$('#avatar2').attr("src", user2.avatar);
		$('#nickname2').text(user2.nickName)
	}

	if (likeList.length > 3) {
		let user3 = likeList[3];
		$('#zongzi3').addClass('active');
		$('#user3').css('display','block');
		$('#avatar3').attr("src", user3.avatar);
		$('#nickname3').text(user3.nickName)
	}
}

function showUserInfo(user) {
	$("#like").css('display','none');
	$("#titleTips").text('全部集齐可以打开礼包');

	if(user.userGift && user.userGift.status > 0) {
		$('#mygift').css('display', 'block');
	} else {
		$('#mygift').css('display', 'none');
		console.log("showUserInfo() #mygift display none");
	}

	if (user.likeList.length >= 4) {
		$("#play").css('display','none');
		$("#gift").css('display','block');
		
		$("#statusTips").text("恭喜您集齐了4个粽子，可以打开礼包啦！");
	} else {
		$("#play").css('display','block');
		$("#gift").css('display','none');
	}

	showGameData(user);
}

function showShareUserInfo(shareUser) {

	
	$("#play").css('display','none'); 
	$("#gift").css('display','none'); 
	$("#mygift").css('display','none');
	console.log("showShareUserInfo() #mygift display none");
	$("#titleTips").text('邀您助力集粽子领礼品');

	let likeCount = shareUser.likeList.length;
	if (likeCount >= 4) {
		$("#statusTips").text("您的好友集齐了4个粽子！可以打开礼包啦！");
		$("#wantPlay").css('display','block');
		$("#like").css('display','none');
	} else {
		let remain = 4 - likeCount;
		$("#statusTips").text("您的好友还差" + remain + "个粽子就能打开礼包");
		$("#like").css('display','block');
	}

	showGameData(shareUser);
}

function showLikeSuccess(shareUser) {
	$('#likeSuccess').fadeIn();
	$('#mask1').fadeIn();

	showShareUserInfo(shareUser);
}

function showLikeFailure(res) {
	if (res.code == 1018) {
		$('#duplacatedLike').fadeIn();
	    $('#mask1').fadeIn();
	} else {
		alert(res.message);
	}
}

   
</script>
</body>
</html>